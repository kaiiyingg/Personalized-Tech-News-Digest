{% extends 'base.html' %}
{% block title %}Home{% endblock %}
{% block content %}
<main class="main-content">
  <div class="digest-stream">
    <h2 style="text-align:center; font-size:2.6em; font-family:'Orbitron','Montserrat','Segoe UI',monospace,sans-serif; font-weight:900; color:#00bfff; margin-bottom:2.5rem;">
      Good to See You, {{ username }}! Your Pulse is Live
      <img src="/static/imgs/BlueHeartbeat.jpg" alt="Blue heartbeat" style="height: 1.2em; vertical-align: middle; margin-left: 0.3em;">
    </h2>
    <div class="search-bar-wrapper" style="width:100%; display:flex; justify-content:center; align-items:center; margin-bottom:2.5rem;">
      <form class="search-form" method="GET" action="{{ url_for('index') }}" style="display: flex; align-items: center; gap: 1.2rem; max-width: 700px; width:100%; justify-content:center;">
        <input type="text" name="q" placeholder="Explore tech newsâ€¦" value="{{ request.args.get('q', '') }}" style="flex: 1; min-width: 300px; max-width: 500px; font-size: 1.5rem; height: 60px; padding: 0 2rem; border-radius: 100px; border: 2px solid #00bfff; background: transparent; color: #e3e3e3; box-sizing: border-box; vertical-align: middle; font-family:'Orbitron','Montserrat','Segoe UI',monospace,sans-serif; font-weight:600;">
        <button type="submit" class="super-button" style="height: 60px; padding: 0 32px; font-size: 1.3rem; min-width: 120px; border-radius: 100px; display: flex; align-items: center; justify-content: center; vertical-align: middle; font-family:'Orbitron','Montserrat','Segoe UI',monospace,sans-serif; font-weight:700;">
          Search
          <span class="arrow" style="font-size:1.5em;">&#8594;</span>
        </button>
      </form>
    </div>
    {% if articles and articles[0].get('instruction') %}
      {{ articles[0]['instruction'] | safe }}
    {% endif %}
    {% if articles %}
      <div class="articles-list">
        {% for article in articles %}
          {% if not article.get('instruction') %}
          <div class="article-card">
            <h3>{{ article['title'] }}</h3>
            <div style="margin-bottom:0.7em;"><a href="{{ article['article_url'] }}" target="_blank" style="color:#00bfff; font-weight:600; text-decoration:underline;">Full Article</a></div>
            <div class="article-meta">
              <span class="source">Source: {{ article['source_name'] }}</span>
              <span class="date">Published: {{ article['published_at'] or 'No date' }}</span>
            </div>
            <p>{{ article['summary'] }}</p>
            <div class="article-actions">
              {% if article['is_liked'] %}
                <form method="POST" action="{{ url_for('unlike_article', article_id=article['id']) }}" style="display:inline;">
                  <button type="submit" class="btn-like liked">&#9733; Liked</button>
                </form>
              {% else %}
                <form method="POST" action="{{ url_for('like_article', article_id=article['id']) }}" style="display:inline;">
                  <button type="submit" class="btn-like heart-button" id="heart-{{ article['id'] }}"></button>
                </form>
              {% endif %}
            </div>
          </div>
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}
  </div>
</main>
{% endblock %}