{% extends 'base.html' %}
{% block title %}Good to See You, {{ username }}! Your Pulse is Live.{% endblock %}
{% block content %}
<main class="main-content">
  <div class="digest-stream">
    <h2 style="text-align:center; font-size:2.6em; font-family:'Orbitron','Montserrat','Segoe UI',monospace,sans-serif; font-weight:900; color:#00bfff; margin-bottom:2.5rem;">Good to See You, {{ username }}! Your Pulse is Live.</h2>
    <div class="search-bar-wrapper" style="width:100%; display:flex; justify-content:center; align-items:center; margin-bottom:2.5rem;">
      <form class="search-form" method="GET" action="{{ url_for('index') }}" style="display: flex; align-items: center; gap: 1.2rem; max-width: 700px; width:100%; justify-content:center;">
        <input type="text" name="q" placeholder="Explore tech newsâ€¦" value="{{ request.args.get('q', '') }}" style="flex: 1; min-width: 300px; max-width: 500px; font-size: 1.5rem; height: 60px; padding: 0 2rem; border-radius: 100px; border: 2px solid #00bfff; background: transparent; color: #e3e3e3; box-sizing: border-box; vertical-align: middle; font-family:'Orbitron','Montserrat','Segoe UI',monospace,sans-serif; font-weight:600;">
        <button type="submit" class="super-button" style="height: 60px; padding: 0 32px; font-size: 1.3rem; min-width: 120px; border-radius: 100px; display: flex; align-items: center; justify-content: center; vertical-align: middle; font-family:'Orbitron','Montserrat','Segoe UI',monospace,sans-serif; font-weight:700;">
          Search
          <span class="arrow" style="font-size:1.5em;">&#8594;</span>
        </button>
      </form>
    </div>
    {% if articles and articles[0].instruction %}
      {{ articles[0].instruction | safe }}
    {% endif %}
    {% if articles %}
      <div class="articles-list">
        {% for article in articles %}
          <div class="article-card">
            <h3><a href="{{ article.article_url }}" target="_blank">{{ article.title }}</a></h3>
            <div class="article-meta">
              <span class="source">Source: {{ article.source_name }}</span>
              <span class="date">Published: {{ article.published_at or 'No date' }}</span>
              <span class="ingested">Ingested: {{ article.ingested_at }}</span>
              <span class="updated">Updated: {{ article.updated_at or 'N/A' }}</span>
            </div>
            <p>{{ article.summary }}</p>
            <div class="article-actions">
              <form method="POST" action="{{ url_for('mark_read', article_id=article.id) }}" style="display:inline;">
                <button type="submit" class="btn-read">{% if article.is_read %}Mark Unread{% else %}Mark Read{% endif %}</button>
              </form>
              {% if article.is_liked %}
                <form method="POST" action="{{ url_for('unlike_article', article_id=article.id) }}" style="display:inline;">
                  <button type="submit" class="btn-like liked">&#9733; Liked</button>
                </form>
              {% else %}
                <form method="POST" action="{{ url_for('like_article', article_id=article.id) }}" style="display:inline;">
                  <button type="submit" class="btn-like">&#9734; Like</button>
                </form>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</main>
{% endblock %}